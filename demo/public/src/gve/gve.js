angular.module('gveApp', [])
    .directive('compile', ['$compile', function ($compile) {
        return function(scope, element, attrs) {
            scope.$watch(
                function(scope) {
                    // watch the 'compile' expression for changes
                    return scope.$eval(attrs.compile);
                },
                function(value) {
                    // when the 'compile' expression changes
                    // assign it into the current DOM
                    element.html(value);

                    // compile the new DOM and link it to the current
                    // scope.
                    // NOTE: we only compile .childNodes so that
                    // we don't get into infinite loop compiling ourselves
                    $compile(element.contents())(scope);
                }
            );
        };
    }])
    .controller('MainCtrl', ['$scope', '$http', function ($scope, $http) {
        $scope.loading_fact_explainer = false;
        $scope.loading_counterfact_explainer = true;
        $scope.server = "http://localhost:5000";

        $scope.overlay = function(image_index, overlay_index) {
            $scope.overlayTracker[image_index] = overlay_index;
        };

        var dataAURI = "data:image/jpeg;base64,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";
        var dataBURI = "data:image/jpeg;base64,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";

        $scope.addOverlayAnchors = function (image) {
            var imageIndex = $scope.images.indexOf(image);
            var displayText = image.display;
            image.overlays = [];
            image.links = {
                "with": dataAURI,
                "has a": dataBURI
            };
            var i = 1;
            for (var link in image.links) {
                var parts = displayText.split(link);
                if (parts.length == 2) {
                    displayText = parts[0] + "<span ng-mouseleave=\"overlay(" + imageIndex + ", -1)\" ng-mouseover=\"overlay(" + imageIndex + ", " + i + ")\" class='anchor anchor" + i++ + "'>" + link + "</span>" + parts[1];
                    image.overlays.push(image.links[link]);
                }
            }
            image.display = displayText;
            return image;
        };

        $scope.displayExplanation = function (image) {
            image.display = "This is a <span class='class_label'>" + image.class_label.split("_").join(" ") + "</span> because " + image.explanation;
            return image;
        };

        $scope.explain = function (image_index) {
            $scope.current = image_index;
            $scope.sample_explanation = "Loading...";
            $http.get($scope.server + '/explain/' + $scope.sample_images[$scope.current].id).then(function (response) {
                $scope.sample_explanation = $scope.displayExplanation(response.data).display;
            });
        };

        $scope.load_sample_images = function () {
            $scope.sample_images = [];
            $http.get($scope.server + '/sample_images/10').then(function (response) {
                $scope.sample_images = response.data;
                $scope.explain(0);
            });
        };

        $scope.load_classes = function () {
            $scope.classes = [];
            $http.get($scope.server + '/classes').then(function (response) {
                $scope.classes = response.data;
                $scope.retry();
            });
        };

        $scope.retry = function () {
            $scope.loading_counterfact_explainer = true;
            $scope.explanation = "";
            $scope.images = [];
            $scope.correct_class_label = "";
            $scope.result = false;
            var class1 = $scope.classes[Math.floor(Math.random() * $scope.classes.length)];
            var index = $scope.classes.indexOf(class1);
            var classes = angular.copy($scope.classes);
            classes.splice(index, 1);
            var class2 = classes[Math.floor(Math.random() * classes.length)];
            $http.get($scope.server + '/counter_factual' + '/' + class1 + '/' + class2).then(function (response) {
                $scope.explanation = response.data.images[0].explanation;
                $scope.correct_class_label = response.data.images[0].class_label;
                $scope.images = shuffle(response.data.images);
                $scope.loading_counterfact_explainer = false;
                $scope.answered = false;
                $scope.result = false;
                $scope.overlayTracker = [];
                var numberOfImages = $scope.images.length;
                while(numberOfImages--) $scope.overlayTracker.push(-1);
            });
        };

        $scope.load_sample_images();
        $scope.load_classes();

        function shuffle(array) {
            var currentIndex = array.length, temporaryValue, randomIndex;

            // While there remain elements to shuffle...
            while (0 !== currentIndex) {

                // Pick a remaining element...
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex -= 1;

                // And swap it with the current element.
                temporaryValue = array[currentIndex];
                array[currentIndex] = array[randomIndex];
                array[randomIndex] = temporaryValue;
            }

            return array;
        }

        $scope.select = function (image) {
            $scope.answered = true;
            $scope.result = $scope.correct_class_label == image.class_label;
        };
    }]);
